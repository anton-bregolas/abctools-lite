<!DOCTYPE html>
<html>
	<head>
		
		<title>ABC Tools Lite Uninstaller</title>
		
		<meta charset="UTF-8">
		<meta http-equiv="Content-Type" content="text/html">
		<meta content="ABC player transpose jig reel folk folktab folktab.com" name="keywords">
		<meta content="A simple-to-use ABC to standard music notation converter featuring tune play, transposition, tab generation, PDF export, and much more!" name="description">
		<meta content="A simple-to-use ABC to standard music notation converter featuring tune play, transposition, tab generation, PDF export, and much more!" name="abstract">
		<meta property="og:locale" content="en_US" />
		<meta name="description" content="A simple-to-use ABC to standard music notation converter featuring tune play, transposition, tab generation, PDF export and much more!" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content="Uninstall ABC Tools Lite" />
		<meta property="og:description" content="A simple-to-use ABC to standard music notation converter featuring tune play, transposition, tab generation, PDF export and much more!" />
		<meta property="og:url" content="https://anton-bregolas.github.io/abctools-lite/uninstall.html" />
		<meta property="og:site_name" content="Uninstall ABC Tools Lite" />
		<meta property="og:image" content="./img/abclite-icon-512x512.png" />
		<meta name="theme-color" content="#181818">
		<meta name="apple-mobile-web-app-title" content="Uninstall ABC Tools Lite">
		<meta name="application-name" content="Uninstall ABC Tools Lite">
    <link rel="icon" href="favicon.ico" sizes="any">
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="./img/apple-touch-icon.png">

		<style>
		.btn {
		  --color: #000000;
		  --background-color: #d8d8d8;
		  /* --border-color: darken(#d8d8d8, 7.5%); */
		  --border-color: gray;
		  color: var(--color);
		  font-family: helvetica !important;
		  font-size: 11pt !important;
			font-weight: bold;
		  background-color: var(--background-color);
		  padding: 0.7rem 0.7rem;
		  padding-top: 0.8rem;
		  border: solid 1px var(--border-color);
		  outline: none;
		  position: relative;
		  border-radius: 0.5rem;
		  user-select: none;
		  /* box-shadow: 0 0.1rem 0.1rem rgba(0, 0, 0, 0.25), 0 -0.1rem 0.5rem rgba(0, 0, 0, 0.1) inset; */
		  -webkit-appearance:none;
		}
		.btn:after {
		  content: "";
		  background-color: #ffffff;
		  width: 75%;
		  height: 12.5%;
		  position: absolute;
		  top: 0.15rem;
		  left: 12.5%;
		  border-radius: 50%;
		  filter: blur(0.15rem);
		}
		.btn:active {
		  /* box-shadow: 0 0 0 rgba(0, 0, 0, 0.4), 0 0.4rem 1rem rgba(0, 0, 0, 0.3) inset; */
			color: tomato;
		}
		.btn:active:after {
		  opacity: 0;
		}

		.btn-info {
		  --color: black;
		  --background-color: #FFDDDD;
		}
		.btn-info:active {
		  --color: #ececec;
		}	

		@media (hover: hover) {
			.unregistersw:hover{
			background: palegreen;
			}
		}

		</style>
			
		<script>
		
		//
		// Delete all the databases
		//
		function delete_all_DB(){

			// Delete legacy reverb impulses database
			const DBDeleteRequest0 = window.indexedDB.deleteDatabase("reverb_impulses");

			DBDeleteRequest0.onerror = (event) => {
			  console.log("Error deleting reverb_impulses database.");
			};

			DBDeleteRequest0.onsuccess = (event) => {
			  console.log("reverb_impulses database deleted successfully");
			};

			setTimeout(function(){

				const DBDeleteRequest1 = window.indexedDB.deleteDatabase("reverb_impulses_all");

				DBDeleteRequest1.onerror = (event) => {
				  console.log("Error deleting reverb_impulses_all database.");
				};

				DBDeleteRequest1.onsuccess = (event) => {
				  console.log("reverb_impulses_all database deleted successfully");
				};

			},500);

			setTimeout(function(){

				const DBDeleteRequest2 = window.indexedDB.deleteDatabase("tune_search_database");

				DBDeleteRequest2.onerror = (event) => {
				  console.log("Error deleting tune_search_database database.");
				};

				DBDeleteRequest2.onsuccess = (event) => {
				  console.log("tune_search_database database deleted successfully");
				};

			},500);


			setTimeout(function(){

				const DBDeleteRequest3 = window.indexedDB.deleteDatabase("samples");

				DBDeleteRequest3.onerror = (event) => {
				  console.log("Error deleting samples database.");
				};

				DBDeleteRequest3.onsuccess = (event) => {
				  console.log("Samples database deleted successfully");
				};

			},500);

		}	

		function unregisterServiceWorker(){

			var alertShown = false;

			// Unregister service worker
			navigator.serviceWorker.getRegistrations()
			 .then(registrations => {

			 	if (registrations.length == 0){
			 		alert("No installed ABC Tools Lite found");
			 	}
			 	else
			 	{
				   	registrations.map(r => {

				   		if (r.scope.indexOf("abclite") != -1){
				   			console.log("Unregistering ABC Tools Lite service worker at scope: "+r.scope);
							r.unregister();
						}
						
						if (!alertShown){
							alertShown = true;
							alert("ABC Tools Lite have been uninstalled");
						}
				   	});
				}

			});
		}

		function deleteCaches(){ 

			caches.keys().then((keys) => {
	          return Promise.all(
	            keys.map((key) => {if ((key.indexOf("abclitecache") != -1) || (key.indexOf("cache-20") != -1)){caches.delete(key)}})
	          );
        	})

		}

		function doUninstall(){
			
			// Delete the databases
			delete_all_DB();

			// Delete all caches
			deleteCaches();

			// Unregister the service worker and delete the service worker cache
			unregisterServiceWorker();

		}

		</script>		
				
	</head>

	<body>

		<h1 style="text-align:center;font-size:18pt;font-family:helvetica;margin-top:36px">Uninstall ABC Tools Lite</h1>

		<p style="text-align:center;font-size:14pt;font-family:helvetica;margin-top:48px">Click the button below to uninstall the tools from your browser and delete all cached resources.</p>

		<p style="text-align:center;font-size:14pt;font-family:helvetica;margin-top:48px"><input id="unregistersw" class="btn btn-info unregistersw" onclick="doUninstall();" type="button" value="Click here to Uninstall ABC Tools Lite" title="Click here to Uninstall ABC Tools Lite from your Browser">

	</body>


</html>
